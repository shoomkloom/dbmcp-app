<div class="main-container flex-column px-2 justify-content-center align-items-center">

    <!-- Message container for 'Copied!' feedback -->
    <div id="message-container" class="message-container"></div>

    <!-- Top section with logo, titles, and GitHub link -->
    <header class="header-container py-1 px-4 w-100 position-relative">
        <!-- Centered titles block (the pageâ€™s true center) -->
        <div class="title-container mx-auto text-center">
            <!-- Logo sits just to the left of the centered block; does NOT affect centering -->
            <img
                src="assets/logo.png"
                alt="DBMCP Logo"
                class="logo-img"
            />

            <!-- Titles -->
            <div class="titles">
                <h1 class="main-title mb-1">Instant DB MCP Server</h1>
                <h4 class="main-title text-success mb-1">Supports MongoDB, PostgreSQL and MySQL</h4>
                <h5 class="main-title">Provides agent tools to help you query your DBs</h5>
            </div>
        </div>

        <!-- GitHub Link pinned to far right; does not affect centering -->
        <a
            href="https://github.com/shoomkloom/dbmcp-server"
            target="_blank"
            class="github-link position-absolute top-0 end-0 me-4 mt-3">
            <i class="fab fa-github me-2"></i>
            <span>GitHub</span>
        </a>
    </header>

    <!-- Main content sections -->
    <main class="py-1">
        <!-- Intro section -->
        <div class="intro-row mb-2">
            <div class="intro-title text-center flex-text">
                <p>Using an MCP server with your AI assistant is almost like magic.<br>Using it with your DB is even better!</p>
                <p>You can get quick insights into your data without remembering complex SQL or MongoDB syntax.</p>
                <p>Even better: because you are using an MCP server with tools, you get more reliable answers: the LLM is generating the query but not the actual code to execute it.</p>
            </div>
            <div class="intro-title text-center flex-img">
                <div class="my-1">MySQL example:</div>
                <img 
                    class="intro-img intro-img--fade" 
                    src="assets/chat01.png" 
                    alt="AI Assistant Chat example"
                    (click)="openOverlay('assets/chat01.png')">
            </div>
            <div class="intro-title text-center flex-img">
                <div class="my-1">PostgreSQL example:</div>
                <img 
                    class="intro-img intro-img--fade" 
                    src="assets/chat02.png" 
                    alt="AI Assistant Chat example"
                    (click)="openOverlay('assets/chat02.png')">
            </div>
        </div>

        <!-- full-screen overlay -->
        <div class="image-overlay" *ngIf="overlaySrc" (click)="closeOverlay()">
            <img class="overlay-image" [src]="overlaySrc" alt="Zoomed image" (click)="$event.stopPropagation()">
            <button class="overlay-close" type="button" aria-label="Close" (click)="closeOverlay()">
                <i class="fa-solid fa-xmark" aria-hidden="true"></i>
            </button>
        </div>

        <!-- Main Title -->
        <div class="sub-title">
            <div class="main-title mt-3">Supports:</div>
            <ul>
                <li><b>MongoDB</b> connection strings: 'mongodb+srv://...' and 'mongodb://...' (Tested with Atlas and Azure CosmosDB).</li>
                <li><b>PostgreSQL</b> connection strings: 'postgresql://...' (Tested with supabase.com).</li>
                <li><b>MySQL</b> connection strings: 'mysql://...'. (Tested with freesqldatabase.com)</li>
            </ul>
        </div>
        <div class="sub-title text-center mt-2">Although I tried to make it non-destructive, it is recommended to use a read-only user</div>

        <div class="sub-title">
            <div class="main-title mt-2">Get started:</div>
            <ol>
                <li>Paste your MongoDB/PostgreSQL/MySQL connection string (without password) in the first panel<br>(be sure to <b>use IPv4</b> compatible connections).</li>
                <li>Copy the generated MCP Server URL from the second panel.</li>
                <li>Follow the instructions below to configure your AI assistant with the provided JSON.</li>
                <li><b>DON'T FORGET:</b> Set your password in the AI assistant configuration!</li>
                <li><b>DON'T FORGET:</b> Set your DB's firewall to allow access to this IP: 208.77.244.15.</li>
            </ol>
        </div>

        <!-- Panel 1: DB connection string -->
        <div class="card panel-card mt-3">
            <div class="card-body">
                <h5 class="panel-title">Paste your (IPv4 compatible) connection string here:</h5>
                <input type="text" id="url-input" 
                    class="form-control url-input" 
                    placeholder="e.g: mongodb+srv://username@cluster0.xxxxx.mongo"
                    [(ngModel)]="connectionString" (ngModelChange)="connectionStringChanged($event)" name="connectionString">
            </div>
        </div>

        <!-- Panel 2: MCP Server URL -->
        <div class="card panel-card">
            <div class="card-body">
                <h5 class="panel-title">Copy the MCP Server URL from here:</h5>
                <div class="input-group">
                    <div 
                        id="mcp-div"
                        class="form-control url-output">
                        {{ mcpUrl }}
                    </div>
                    <button class="btn btn-copy" type="button" (click)="copyToClipboard('mcp-div')">
                        <i class="far fa-copy"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Panel 3: Connect your AI assistant -->
        <div class="card panel-card">
            <div class="card-body">
                <h5 class="panel-title">Connect your AI assistant:</h5>
                <div class="button-grid">
                    <button class="btn assistant-btn" 
                        [class.active]="isActive('cursor')" 
                        (click)="setActive('cursor')"><img src="assets/cursor.png" class="mx-1">Cursor</button>
                    <button class="btn assistant-btn"
                        [class.active]="isActive('claude')" 
                        (click)="setActive('claude')"><img src="assets/claude.png" class="mx-1">Claude Desktop</button>
                    <button class="btn assistant-btn"
                        [class.active]="isActive('windsurf')" 
                        (click)="setActive('windsurf')"><img src="assets/windsurf.png" class="mx-1">Windsuf</button>
                    <button class="btn assistant-btn"
                        [class.active]="isActive('vscode')" 
                        (click)="setActive('vscode')"><img src="assets/vscode.png" class="mx-1">VSCode</button>
                    <button class="btn assistant-btn"
                        [class.active]="isActive('cline')" 
                        (click)="setActive('cline')"><img src="assets/cline.png" class="mx-1">Cline</button>
                    <!--button class="btn assistant-btn"
                        [class.active]="isActive('highlight')" 
                        (click)="setActive('highlight')"><img src="assets/highlight.png" class="mx-1">Highlight AI</button>
                    -->
                    <button class="btn assistant-btn"
                        [class.active]="isActive('augment')" 
                        (click)="setActive('augment')"><img src="assets/augment.png" class="mx-1">Augment Code</button>
                    <button class="btn assistant-btn"
                        [class.active]="isActive('mysty')" 
                        (click)="setActive('mysty')"><img src="assets/msty.jpg" class="mx-1">Msty AI</button>
                </div>
                <div class="d-flex justify-content-between align-items-center text-break mb-2 mt-3">
                    <p *ngIf="activeAssistant === 'cursor'" class="code-title mb-0">To add this MCP to VSCode, update your <span>.vscode/mcp.json</span> :</p>
                    <p *ngIf="activeAssistant === 'claude'" class="code-title mb-0">To add this MCP to Claude Desktop, update your <span>claude_desktop_config.json</span> :</p>
                    <p *ngIf="activeAssistant === 'windsurf'" class="code-title mb-0">To add this MCP to Windsurf, update your <span>windsurf/mcp_config.json</span> :</p>
                    <p *ngIf="activeAssistant === 'vscode'" class="code-title mb-0">To add this MCP to VSCode, update your <span>.vscode/mcp.json</span> :</p>
                    <p *ngIf="activeAssistant === 'cline'" class="code-title mb-0">To add this MCP to Cline, update your <span>settings/cline_mcp_settings.json</span> :</p>
                    <div *ngIf="activeAssistant === 'augment'" class="code-title mb-0">
                        <li>Open Augment Code settings</li>
                        <li>Navigate to the MCP section</li>
                        <li>Add a new MCP server with the following details</li>
                        <div>Name the MCP server:</div>
                        <span>dbmcp-{{dbuser}}</span> 
                        <div>Use this command:</div>
                        <span>npx mcp-remote ${{mcpUrl}}</span>
                        <div>Or use the following configuration:</div>
                    </div>
                    <p *ngIf="activeAssistant === 'mysty'" class="code-title mb-0">Copy the following JSON configuration:</p>
                    <div class="code-actions">
                        <button class="btn btn-sm btn-action" (click)="copyCode()"><i class="far fa-copy"></i></button>
                    </div>
                </div>
                <div class="code-block" id="code-block-content">
                    <pre>
                        <code>{{ mcpJsonContent }}
                        </code>
                    </pre>
                </div>
            </div>
        </div>
    </main>

  <!-- Footer with links -->
  <footer class="footer-panel w-100">
    <div class="d-flex flex-wrap justify-content-center align-items-center h-100 px-5 gap-3">
      <a href="https://cursor.com/" target="_blank" class="footer-link"><img src="assets/cursor.png" class="mx-1">Cursor</a>
      <a href="https://claude.ai/" target="_blank" class="footer-link"><img src="assets/claude.png" class="mx-1">Claude</a>
      <a href="https://windsurf.com/editor/" target="_blank" class="footer-link"><img src="assets/windsurf.png" class="mx-1">Windsurf</a>
      <a href="https://code.visualstudio.com/" target="_blank" class="footer-link"><img src="assets/vscode.png" class="mx-1">VSCode</a>
      <a href="https://cline.bot/" target="_blank" class="footer-link"><img src="assets/cline.png" class="mx-1">Cline</a>
      <!--<a href="https://highlight.io/" target="_blank" class="footer-link"><img src="assets/highlight.png" class="mx-1">Highlight AI</a>-->
      <a href="https://www.augmentcode.com/" target="_blank" class="footer-link"><img src="assets/augment.png" class="mx-1">Augment Code</a>
      <a href="https://msty.ai/" target="_blank" class="footer-link"><img src="assets/msty.jpg" class="mx-1">Msty AI</a>
    </div>
  </footer>
</div>